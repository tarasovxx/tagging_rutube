# tagging_rutube

## Users Jokers üå†

–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–∏—Å—Ç–µ–º—É —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è –≤–∏–¥–µ–æ. –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ
—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–º—É —Å–ø–∏—Å–∫—É —Ç–µ–≥–æ–≤ –¥–ª—è web –ø–ª–∞—Ç—Ñ–æ—Ä–º, —à–∏—Ä–æ–∫–æ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–µ–º—É —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–µ–º–∞—Ç–∏–∫–∏ –∏ –ø–æ–¥—Ç–µ–º–∞—Ç–∏–∫–∏. –í —Ä–µ—à–µ–Ω–∏–∏
—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ—Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–µ–≥ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ–≥ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π
—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π. –í–∏–¥–µ–æ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫.

![–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã](docs/demo.gif)

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- BERT –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ç–µ–≥–æ–≤ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é/—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ (torch, BERT)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∏–¥–µ–æ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ç–µ–≥–æ–≤ (Mock DB request)
- –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –º–æ–¥—É–ª–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –≤–∏–¥–µ–æ (Whisper)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/tarasovxx/tagging_rutube
   cd tagging_rutube
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –≤–µ—Ä—Å–∏–∏ 3.9 –∏ –≤—ã—à–µ. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```bash
   python -m venv venv
   source venv/bin/activate
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
4. –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏

   ```bash
   pip install -r requirements_base.txt
   ```

5*. –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º –≤–∏–¥–µ–æ
   ```bash
   pip install -r requirements.txt
   ```

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–û–±—É—á–µ–Ω–∏–µ BERT-–º–æ–¥–µ–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ–∞–π–ª–µ [bert.ipynb](baseline/bert.ipynb), 
–≥–¥–µ –≤—Å–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–æ –ø–æ —à–∞–≥–∞–º, –≤–∫–ª—é—á–∞—è –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∞–º–æ–≥–æ —Ñ–∞–π–ª–∞ –º–æ–¥–µ–ª–∏.

–ü–∞–ø–∫–∞ `model` –∫–ª–∞–¥–µ—Ç—Å—è –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞, –æ—Ç—Ç—É–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å

# –ü—Ä–æ —Ñ–∞–π–ª—ã

- baseline - –ø–∞–ø–∫–∞ —Å –±–µ–π–∑–ª–∞–π–Ω–æ–º –∏ –Ω–æ—É—Ç–±—É–∫–æ–º —Å –æ–±—É—á–µ–Ω–∏–µ–º BERT
- app.py - –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∏–º–ª–∏—Ç–µ
- category_mapping.py - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- handler.py - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è mp4 –≤ —Ç–µ–∫—Å—Ç
- model_loader.py - –º–æ–¥—É–ª—å –ø–æ —Ä–∞–±–æ—Ç–µ —Å BERT-–º–æ–¥–µ–ª—å—é
- summarization.py - —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- utils.py - –ø—Ä–æ—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Rutube-–≤–∏–¥–µ–æ

# –ó–∞–ø—É—Å–∫
```bash
streamlit run app.py
```

# –°—Ç–µ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- Python3
- pytorch
- transformers
- Streamlit

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
–í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **Whisper** –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç. –ó–∞—Ç–µ–º —Å –ø–æ–º–æ—â—å—é **Transformers** –º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **Streamlit**.

–≠—Ç–æ—Ç —Å—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∏ –∞—É–¥–∏–æ–¥–∞–Ω–Ω—ã–µ, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —É–¥–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞.

## Docker
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Docker –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –º–æ–≥ –ª–µ–≥–∫–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ª—é–±–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ. Docker –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/tarasovxx/tagging_rutube
   ```
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:
   ```bash
   cd tagging_rutube
   ```
3. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ Docker-–æ–±—Ä–∞–∑:
   ```bash
   docker build -t tagging_rutube .
   ```
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
   ```bash
   docker run -p 8501:8501 tagging_rutube
   ```

# –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏

| –ò–º—è                | –†–æ–ª—å             | –ö–æ–Ω—Ç–∞–∫—Ç                                  |
|--------------------|------------------|------------------------------------------|
| –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ë–∞–ª—Ü–∞—Ç  | Data Analysis    | [t.me/baltsat](https://t.me/baltsat)     |
| ---                | ---              | ---                                      |
| –ê—Ä—Ç–µ–º –¢–∞—Ä–∞—Å–æ–≤      | Full Stack       | [t.me/tarasovxx](https://t.me/tarasovxx) |
| ---                | ---              | ---                                      |
| –•–∞—Ä–ª–∞–º–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä | Machine Learning | [t.me/Wignorbo](https://t.me/@Wignorbo)  |
| ---                | ---              | ---                                      |
| –î–∞–Ω–∏–∏–ª –ì–∞–ª–∏–º–æ–≤     | Data Analysis    | [t.me/Dan_Gan](https://t.me/Dan_Gan)     |
| ---                | ---              | ---                                      |
